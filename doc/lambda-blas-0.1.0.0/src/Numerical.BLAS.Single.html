<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><a name="line-5"></a><span class="hs-comment">{- | This module provides BLAS level-1 library functions for vectors of
single precision floating point numbers.  In general, BLAS level-1 functions
that take vector valued arguments support the ability to apply their
functionality over all the elements in the vector, or to a smaller vector
comprised of elements drawn in uniform intervals from the original
vector argument.   This capability allows vector operations to be applied,
for example, to columns of matrices.

To support this capability, each BLAS level-1 function that has at least
one vector valued argument takes an Int parameter, n, that represents the
number of elements to be extracted from the vector arguments.  The function
also will take an additional Int argument for each vector valued argument,
representing the both the direction of traversal and the interval between
elements are drawn of the original vector argument.   Typically n is the first
Int valued argument, and the increments are the first Int valued argment
following a vector agument.

For example:

@
sdot :: Int -&gt; Vector Float -&gt; Int -&gt; Vector Float -&gt; Int -&gt; Float
sdot n sx incx sy incy = foldl' (+) 0 $ zipWith (*) (sampleElems n sx incx) (sampleElems n sy incy)
@

is morally equivalent to the dot product of the vectors sx and sy when both
vectors have lengths of n and both incx and incy are unity.

The BLAS functions do not generally guard against invalid values of the increment
arguments.   For each vector argument v, and each increment inc, the calling
program should ensure that:

@
inc /= 0
length v &gt;= (1 + (n-1)*inc)
@
-}</span><span>
</span><a name="line-41"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Numerical</span><span class="hs-operator">.</span><span class="hs-identifier">BLAS</span><span class="hs-operator">.</span><span class="hs-identifier">Single</span><span class="hs-special">(</span><span>
</span><a name="line-42"></a><span>   </span><span class="hs-comment">-- * Norms</span><span>
</span><a name="line-43"></a><span>   </span><a href="Numerical.BLAS.Single.html#asum"><span class="hs-identifier hs-var">asum</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#sasum"><span class="hs-identifier hs-var">sasum</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#dasum"><span class="hs-identifier hs-var">dasum</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>   </span><a href="Numerical.BLAS.Single.html#nrm2"><span class="hs-identifier hs-var">nrm2</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#snrm2"><span class="hs-identifier hs-var">snrm2</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#dnrm2"><span class="hs-identifier hs-var">dnrm2</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>   </span><span class="hs-comment">-- * Products</span><span>
</span><a name="line-46"></a><span>   </span><a href="Numerical.BLAS.Single.html#dot"><span class="hs-identifier hs-var">dot</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#sdot"><span class="hs-identifier hs-var">sdot</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#ddot"><span class="hs-identifier hs-var">ddot</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>   </span><a href="Numerical.BLAS.Single.html#sdsdot"><span class="hs-identifier hs-var">sdsdot</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>   </span><a href="Numerical.BLAS.Single.html#scal"><span class="hs-identifier hs-var">scal</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#sscal"><span class="hs-identifier hs-var">sscal</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#dscal"><span class="hs-identifier hs-var">dscal</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>   </span><span class="hs-comment">-- * Rotations</span><span>
</span><a name="line-50"></a><span>   </span><a href="Numerical.BLAS.Single.html#rot"><span class="hs-identifier hs-var">rot</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#srot"><span class="hs-identifier hs-var">srot</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#drot"><span class="hs-identifier hs-var">drot</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>   </span><a href="Numerical.BLAS.Single.html#rotg"><span class="hs-identifier hs-var">rotg</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#srotg"><span class="hs-identifier hs-var">srotg</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#drotg"><span class="hs-identifier hs-var">drotg</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>   </span><a href="Numerical.BLAS.Single.html#rotm"><span class="hs-identifier hs-var">rotm</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#srotm"><span class="hs-identifier hs-var">srotm</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#drotm"><span class="hs-identifier hs-var">drotm</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>   </span><a href="Numerical.BLAS.Single.html#rotmg"><span class="hs-identifier hs-var">rotmg</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#srotmg"><span class="hs-identifier hs-var">srotmg</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#drotmg"><span class="hs-identifier hs-var">drotmg</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>   </span><span class="hs-comment">-- * Linear Combinations</span><span>
</span><a name="line-55"></a><span>   </span><a href="Numerical.BLAS.Single.html#axpy"><span class="hs-identifier hs-var">axpy</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#saxpy"><span class="hs-identifier hs-var">saxpy</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#daxpy"><span class="hs-identifier hs-var">daxpy</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>   </span><span class="hs-comment">-- * Memory Operations</span><span>
</span><a name="line-57"></a><span>   </span><a href="Numerical.BLAS.Single.html#copy"><span class="hs-identifier hs-var">copy</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#scopy"><span class="hs-identifier hs-var">scopy</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#dcopy"><span class="hs-identifier hs-var">dcopy</span></a><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>   </span><a href="Numerical.BLAS.Single.html#swap"><span class="hs-identifier hs-var">swap</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#sswap"><span class="hs-identifier hs-var">sswap</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#dswap"><span class="hs-identifier hs-var">dswap</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>   </span><span class="hs-comment">-- * Specialized Folds</span><span>
</span><a name="line-60"></a><span>   </span><a href="Numerical.BLAS.Single.html#iamax"><span class="hs-identifier hs-var">iamax</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#isamax"><span class="hs-identifier hs-var">isamax</span></a><span class="hs-special">,</span><a href="Numerical.BLAS.Single.html#idamax"><span class="hs-identifier hs-var">idamax</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="Numerical.BLAS.Types.html"><span class="hs-identifier">Numerical</span><span class="hs-operator">.</span><span class="hs-identifier">BLAS</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="Numerical.BLAS.Util.html"><span class="hs-identifier">Numerical</span><span class="hs-operator">.</span><span class="hs-identifier">BLAS</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Ord</span><span class="hs-special">(</span><span class="hs-identifier hs-var">comparing</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Storable</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Storable</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- | O(n) - compute the sum of products of elements drawn from two Float vectors.</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- This function is morally equivalent to the dot product of vectors x and y</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- when n is the length of both x and y, and both incx and incy are unity.</span><span>
</span><a name="line-73"></a><span class="hs-identifier">dot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434437"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-1627434437"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The number of elements n</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434437"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The first vector, x</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The increment, incx, between elements drawn from x</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434437"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The second vector, y</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The increment, incy,  between elements drawn from y</span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434437"><span class="hs-identifier hs-type">a</span></a><span>        </span><span class="hs-comment">-- ^ The sum of products of the selected elements</span><span>
</span><a name="line-80"></a><span class="hs-pragma">{-# INLINE dot #-}</span><span>
</span><a name="line-81"></a><a name="dot"><a href="Numerical.BLAS.Single.html#dot"><span class="hs-identifier">dot</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434438"><a href="#local-1627434438"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434439"><a href="#local-1627434439"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434440"><a href="#local-1627434440"><span class="hs-identifier">incx</span></a></a><span> </span><a name="local-1627434441"><a href="#local-1627434441"><span class="hs-identifier">sy</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434442"><a href="#local-1627434442"><span class="hs-identifier">incy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Numerical.BLAS.Util.html#sampleElems"><span class="hs-identifier hs-var">sampleElems</span></a><span> </span><a href="#local-1627434438"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434439"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434440"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Numerical.BLAS.Util.html#sampleElems"><span class="hs-identifier hs-var">sampleElems</span></a><span> </span><a href="#local-1627434438"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434441"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434442"><span class="hs-identifier hs-var">incy</span></a><span>
</span><a name="line-83"></a><span class="hs-pragma">{-# DEPRECATED sdot,ddot &quot;Use dot instead.&quot; #-}</span><span>
</span><a name="line-84"></a><span class="hs-identifier">sdot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-85"></a><a name="sdot"><a href="Numerical.BLAS.Single.html#sdot"><span class="hs-identifier">sdot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>
</span><a name="line-86"></a><span class="hs-identifier">ddot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-87"></a><a name="ddot"><a href="Numerical.BLAS.Single.html#ddot"><span class="hs-identifier">ddot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- O(1) - Compute the starting index of an iterative vector traversal</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- given the length of the vector and the iterative step size.</span><span>
</span><a name="line-91"></a><span class="hs-identifier">firstIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ the iterative step</span><span>
</span><a name="line-92"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ The index of the first iterative step</span><span>
</span><a name="line-93"></a><span class="hs-pragma">{-# INLINE firstIndex #-}</span><span>
</span><a name="line-94"></a><a name="firstIndex"><a href="Numerical.BLAS.Single.html#firstIndex"><span class="hs-identifier">firstIndex</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434443"><a href="#local-1627434443"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434444"><a href="#local-1627434444"><span class="hs-identifier">inc</span></a></a><span>
</span><a name="line-95"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434444"><span class="hs-identifier hs-var">inc</span></a><span class="hs-operator hs-var">&gt;</span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-glyph">-</span><a href="#local-1627434443"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><a href="#local-1627434444"><span class="hs-identifier hs-var">inc</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | O(n) - Multiply selected elements in a vector, x, by a scalar, a.   This</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- function is morally equivalent to scalar multiplication a*x when n is the</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- length x and incx is unity.</span><span>
</span><a name="line-101"></a><span class="hs-identifier">scal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434436"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-1627434436"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The number of elements to scale, n</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434436"><span class="hs-identifier hs-type">a</span></a><span>        </span><span class="hs-comment">-- ^ The scalar factor, a</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434436"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The vector to scale, x</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The increment between elements to scale, incx</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434436"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The vector with scaled elements</span><span>
</span><a name="line-107"></a><span class="hs-pragma">{-# INLINE scal #-}</span><span>
</span><a name="line-108"></a><a name="scal"><a href="Numerical.BLAS.Single.html#scal"><span class="hs-identifier">scal</span></a></a><span> </span><a name="local-1627434445"><a href="#local-1627434445"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434446"><a href="#local-1627434446"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627434447"><a href="#local-1627434447"><span class="hs-identifier">sx</span></a></a><span> </span><a name="local-1627434448"><a href="#local-1627434448"><span class="hs-identifier">incx</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeUpdate_</span><span> </span><a href="#local-1627434447"><span class="hs-identifier hs-var">sx</span></a><span> </span><span class="hs-special">(</span><a href="Numerical.BLAS.Util.html#sampleIndices"><span class="hs-identifier hs-var">sampleIndices</span></a><span> </span><a href="#local-1627434445"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434448"><span class="hs-identifier hs-var">incx</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-1627434446"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><a href="Numerical.BLAS.Util.html#sampleElems"><span class="hs-identifier hs-var">sampleElems</span></a><span> </span><a href="#local-1627434445"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434447"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434448"><span class="hs-identifier hs-var">incx</span></a><span>
</span><a name="line-112"></a><span class="hs-pragma">{-# DEPRECATED sscal,dscal &quot;Use scal instead.&quot; #-}</span><span>
</span><a name="line-113"></a><span class="hs-identifier">sscal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-114"></a><a name="sscal"><a href="Numerical.BLAS.Single.html#sscal"><span class="hs-identifier">sscal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#scal"><span class="hs-identifier hs-var">scal</span></a><span>
</span><a name="line-115"></a><span class="hs-identifier">dscal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-116"></a><a name="dscal"><a href="Numerical.BLAS.Single.html#dscal"><span class="hs-identifier">dscal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#scal"><span class="hs-identifier hs-var">scal</span></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- | O(n) - Copy n elements from one Float vector into another.</span><span>
</span><a name="line-119"></a><span class="hs-identifier">copy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434435"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The number of elements to copy</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434435"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The source vector from which to copy elements</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The increment between elements drawn from the source vector</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434435"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The target vector into which elements are copied</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The increment between the destination elements</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434435"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-126"></a><span class="hs-pragma">{-# INLINE copy #-}</span><span>
</span><a name="line-127"></a><a name="copy"><a href="Numerical.BLAS.Single.html#copy"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-1627434449"><a href="#local-1627434449"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434450"><a href="#local-1627434450"><span class="hs-identifier">sx</span></a></a><span> </span><a name="local-1627434451"><a href="#local-1627434451"><span class="hs-identifier">incx</span></a></a><span> </span><a name="local-1627434452"><a href="#local-1627434452"><span class="hs-identifier">sy</span></a></a><span> </span><a name="local-1627434453"><a href="#local-1627434453"><span class="hs-identifier">incy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627434454"><a href="#local-1627434454"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434454"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-1627434449"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434452"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434453"><span class="hs-identifier hs-var">incy</span></a><span> </span><a href="#local-1627434450"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434451"><span class="hs-identifier hs-var">incx</span></a><span>
</span><a name="line-128"></a><span class="hs-pragma">{-# DEPRECATED scopy,dcopy &quot;Use copy instead&quot; #-}</span><span>
</span><a name="line-129"></a><span class="hs-identifier">scopy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-130"></a><a name="scopy"><a href="Numerical.BLAS.Single.html#scopy"><span class="hs-identifier">scopy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#copy"><span class="hs-identifier hs-var">copy</span></a><span>
</span><a name="line-131"></a><span class="hs-identifier">dcopy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-132"></a><a name="dcopy"><a href="Numerical.BLAS.Single.html#dcopy"><span class="hs-identifier">dcopy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#copy"><span class="hs-identifier hs-var">copy</span></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">-- |  O(n) -- Swap n elements between two Float vectors.</span><span>
</span><a name="line-135"></a><span class="hs-identifier">swap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434434"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The number of elements to copy</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434434"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The first vector from which elements will be swapped</span><span>
</span><a name="line-138"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The increment between elements drawn from the first vector</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434434"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The second vector from which elements will be swapped</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The increment between elements drawn from the second vector</span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434434"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434434"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span class="hs-pragma">{-# INLINE swap #-}</span><span>
</span><a name="line-143"></a><a name="swap"><a href="Numerical.BLAS.Single.html#swap"><span class="hs-identifier">swap</span></a></a><span> </span><a name="local-1627434455"><a href="#local-1627434455"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434456"><a href="#local-1627434456"><span class="hs-identifier">sx</span></a></a><span> </span><a name="local-1627434457"><a href="#local-1627434457"><span class="hs-identifier">incx</span></a></a><span> </span><a name="local-1627434458"><a href="#local-1627434458"><span class="hs-identifier">sy</span></a></a><span> </span><a name="local-1627434459"><a href="#local-1627434459"><span class="hs-identifier">incy</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627434460"><a href="#local-1627434460"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434460"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-1627434455"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434456"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434457"><span class="hs-identifier hs-var">incx</span></a><span> </span><a href="#local-1627434458"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434459"><span class="hs-identifier hs-var">incy</span></a><span>
</span><a name="line-145"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627434461"><a href="#local-1627434461"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434461"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-1627434455"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434458"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434459"><span class="hs-identifier hs-var">incy</span></a><span> </span><a href="#local-1627434456"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434457"><span class="hs-identifier hs-var">incx</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span class="hs-pragma">{-# DEPRECATED sswap,dswap &quot;Use swap instead.&quot; #-}</span><span>
</span><a name="line-147"></a><span class="hs-identifier">sswap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><a name="sswap"><a href="Numerical.BLAS.Single.html#sswap"><span class="hs-identifier">sswap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#swap"><span class="hs-identifier hs-var">swap</span></a><span>
</span><a name="line-149"></a><span class="hs-identifier">dswap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><a name="dswap"><a href="Numerical.BLAS.Single.html#dswap"><span class="hs-identifier">dswap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#swap"><span class="hs-identifier hs-var">swap</span></a><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | O(n) - asum computes the sum of the absolute value of elements drawn a</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- vector, x. This function is morally equivalent to the L1 norm</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- when n is equal to the length of x and incx is unity.</span><span>
</span><a name="line-155"></a><span class="hs-identifier">asum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-1627434433"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434433"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ The number of elements to sum, n</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434433"><span class="hs-identifier hs-type">a</span></a><span>    </span><span class="hs-comment">-- ^ The vector from which summands are selected, x</span><span>
</span><a name="line-158"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>           </span><span class="hs-comment">-- ^ The increment between summands, incx</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434433"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-160"></a><span class="hs-pragma">{-# INLINE asum #-}</span><span>
</span><a name="line-161"></a><a name="asum"><a href="Numerical.BLAS.Single.html#asum"><span class="hs-identifier">asum</span></a></a><span> </span><a name="local-1627434462"><a href="#local-1627434462"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434463"><a href="#local-1627434463"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434464"><a href="#local-1627434464"><span class="hs-identifier">incx</span></a></a><span>
</span><a name="line-162"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434464"><span class="hs-identifier hs-var">incx</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span class="hs-number">1</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-163"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Numerical.BLAS.Util.html#sampleElems"><span class="hs-identifier hs-var">sampleElems</span></a><span> </span><a href="#local-1627434462"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434463"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434464"><span class="hs-identifier hs-var">incx</span></a><span>
</span><a name="line-164"></a><span class="hs-pragma">{-# DEPRECATED sasum, dasum &quot;Use asum instead&quot; #-}</span><span>
</span><a name="line-165"></a><span class="hs-identifier">sasum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-166"></a><a name="sasum"><a href="Numerical.BLAS.Single.html#sasum"><span class="hs-identifier">sasum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#asum"><span class="hs-identifier hs-var">asum</span></a><span>
</span><a name="line-167"></a><span class="hs-identifier">dasum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-168"></a><a name="dasum"><a href="Numerical.BLAS.Single.html#dasum"><span class="hs-identifier">dasum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#asum"><span class="hs-identifier hs-var">asum</span></a><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- | O(n) - nrm2 computes the sum of the squared values of elements drawn a</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- vector, x. This function is morally equivalent to the L2 norm</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- when n is equal to the length of x and incx is unity.</span><span>
</span><a name="line-174"></a><span class="hs-identifier">nrm2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-1627434432"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627434432"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434432"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ The number of elements to sum, n</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434432"><span class="hs-identifier hs-type">a</span></a><span>    </span><span class="hs-comment">-- ^ The vector from which summands are selected, x</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>           </span><span class="hs-comment">-- ^ The increment between summands, incx</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434432"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-179"></a><span class="hs-pragma">{-# INLINE nrm2 #-}</span><span>
</span><a name="line-180"></a><a name="nrm2"><a href="Numerical.BLAS.Single.html#nrm2"><span class="hs-identifier">nrm2</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434465"><a href="#local-1627434465"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434466"><a href="#local-1627434466"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434467"><a href="#local-1627434467"><span class="hs-identifier">incx</span></a></a><span>
</span><a name="line-181"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434465"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">&lt;</span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1627434467"><span class="hs-identifier hs-var">incx</span></a><span class="hs-operator hs-var">&lt;</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-182"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434465"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">==</span><span class="hs-number">1</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627434466"><span class="hs-identifier hs-var">sx</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeIndex</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434468"><span class="hs-identifier hs-var">slassq</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434467"><span class="hs-identifier hs-var">incx</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="#local-1627434465"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-185"></a><span>    </span><a name="local-1627434468"><a href="#local-1627434468"><span class="hs-identifier">slassq</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434469"><a href="#local-1627434469"><span class="hs-identifier">imax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434470"><span class="hs-identifier hs-var">slassq_loop</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-number">1.0</span><span>
</span><a name="line-186"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-187"></a><span>        </span><span class="hs-pragma">{-# INLINE slassq_loop #-}</span><span>
</span><a name="line-188"></a><span>        </span><a name="local-1627434470"><a href="#local-1627434470"><span class="hs-identifier">slassq_loop</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434471"><a href="#local-1627434471"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434472"><a href="#local-1627434472"><span class="hs-identifier">scale</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434473"><a href="#local-1627434473"><span class="hs-identifier">ssq</span></a></a><span>
</span><a name="line-189"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434471"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-1627434469"><span class="hs-identifier hs-var">imax</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434472"><span class="hs-identifier hs-var">scale</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sqrt</span><span> </span><a href="#local-1627434473"><span class="hs-identifier hs-var">ssq</span></a><span>
</span><a name="line-190"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-191"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-1627434474"><a href="#local-1627434474"><span class="hs-identifier">xi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434466"><span class="hs-identifier hs-var">sx</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeIndex</span><span class="hs-special">`</span><span> </span><a href="#local-1627434471"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-192"></a><span>                    </span><span class="hs-pragma">{-# INLINE f #-}</span><span>
</span><a name="line-193"></a><span>                    </span><a name="local-1627434475"><a href="#local-1627434475"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627434476"><a href="#local-1627434476"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627434472"><span class="hs-identifier hs-var">scale</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1627434476"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-194"></a><span>                        </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434470"><span class="hs-identifier hs-var">slassq_loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434471"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><a href="#local-1627434467"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434476"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">1.0</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434473"><span class="hs-identifier hs-var">ssq</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-1627434472"><span class="hs-identifier hs-var">scale</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434476"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">^</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>                        </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434470"><span class="hs-identifier hs-var">slassq_loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434471"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><a href="#local-1627434467"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434472"><span class="hs-identifier hs-var">scale</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434473"><span class="hs-identifier hs-var">ssq</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-1627434476"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434472"><span class="hs-identifier hs-var">scale</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">^</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-196"></a><span>                </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-1627434474"><span class="hs-identifier hs-var">xi</span></a><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-197"></a><span>                       </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434470"><span class="hs-identifier hs-var">slassq_loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434471"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><a href="#local-1627434467"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434472"><span class="hs-identifier hs-var">scale</span></a><span> </span><a href="#local-1627434473"><span class="hs-identifier hs-var">ssq</span></a><span>
</span><a name="line-198"></a><span>                       </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434475"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-1627434474"><span class="hs-identifier hs-var">xi</span></a><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>                       </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434475"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627434474"><span class="hs-identifier hs-var">xi</span></a><span>
</span><a name="line-200"></a><span class="hs-pragma">{-# DEPRECATED snrm2, dnrm2 &quot;Use nrm2 instead&quot; #-}</span><span>
</span><a name="line-201"></a><span class="hs-identifier">snrm2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-202"></a><a name="snrm2"><a href="Numerical.BLAS.Single.html#snrm2"><span class="hs-identifier">snrm2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#nrm2"><span class="hs-identifier hs-var">nrm2</span></a><span>
</span><a name="line-203"></a><span class="hs-identifier">dnrm2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-204"></a><a name="dnrm2"><a href="Numerical.BLAS.Single.html#dnrm2"><span class="hs-identifier">dnrm2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#nrm2"><span class="hs-identifier hs-var">nrm2</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- | O(n) - Find the index of the element with the largest absolute value</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- from elements drawn from a vector.   This function is morally</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- equivalent to the index of the element with the largest magnitude when</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- n is the length of the vector x and the increment, inc, is unity.</span><span>
</span><a name="line-211"></a><span class="hs-identifier">iamax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627434431"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-1627434431"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434431"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>         </span><span class="hs-comment">-- ^ The number of elements drawn from the source vector,n</span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434431"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-comment">-- ^ The source vector, x</span><span>
</span><a name="line-214"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>         </span><span class="hs-comment">-- ^ The interval between elements drawn from the source vector, incx</span><span>
</span><a name="line-215"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>         </span><span class="hs-comment">-- ^ The index of the element with the largest absolute value.</span><span>
</span><a name="line-216"></a><span class="hs-pragma">{-# INLINE idamax #-}</span><span>
</span><a name="line-217"></a><a name="iamax"><a href="Numerical.BLAS.Single.html#iamax"><span class="hs-identifier">iamax</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434477"><a href="#local-1627434477"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434478"><a href="#local-1627434478"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434479"><a href="#local-1627434479"><span class="hs-identifier">incx</span></a></a><span>
</span><a name="line-218"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434477"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1627434479"><span class="hs-identifier hs-var">incx</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span>
</span><a name="line-219"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434477"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-220"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">maxIndexBy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">comparing</span><span> </span><span class="hs-identifier hs-var">abs</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Numerical.BLAS.Util.html#sampleElems"><span class="hs-identifier hs-var">sampleElems</span></a><span> </span><a href="#local-1627434477"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434478"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434479"><span class="hs-identifier hs-var">incx</span></a><span>
</span><a name="line-221"></a><span class="hs-pragma">{-# DEPRECATED isamax,idamax &quot;use iamax instead&quot; #-}</span><span>
</span><a name="line-222"></a><span class="hs-identifier">isamax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-223"></a><a name="isamax"><a href="Numerical.BLAS.Single.html#isamax"><span class="hs-identifier">isamax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#iamax"><span class="hs-identifier hs-var">iamax</span></a><span>
</span><a name="line-224"></a><span class="hs-identifier">idamax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-225"></a><a name="idamax"><a href="Numerical.BLAS.Single.html#idamax"><span class="hs-identifier">idamax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#iamax"><span class="hs-identifier hs-var">iamax</span></a><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">-- | O(n) - compute the sum of products of elements drawn from two Float vectors</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- using Double precision internally. This function is morally equivalent to the</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- dot product of vectors x and y when n is the length of both x and y, and both</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- incx and incy are unity.</span><span>
</span><a name="line-231"></a><span class="hs-identifier">sdsdot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>            </span><span class="hs-comment">-- ^ The number of elements n</span><span>
</span><a name="line-232"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span>          </span><span class="hs-comment">-- ^ a Vector valued adjustment to add to the sum</span><span>
</span><a name="line-233"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-comment">-- ^ The first vector, x</span><span>
</span><a name="line-234"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>            </span><span class="hs-comment">-- ^ The increment, incx, between elements drawn from x</span><span>
</span><a name="line-235"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-comment">-- ^ The second vector, y</span><span>
</span><a name="line-236"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>            </span><span class="hs-comment">-- ^ The increment, incy,  between elements drawn from y</span><span>
</span><a name="line-237"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span>          </span><span class="hs-comment">-- ^ The sum of products of the selected elements</span><span>
</span><a name="line-238"></a><a name="sdsdot"><a href="Numerical.BLAS.Single.html#sdsdot"><span class="hs-identifier">sdsdot</span></a></a><span> </span><a name="local-1627434480"><a href="#local-1627434480"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Numerical.BLAS.Util.html#floatToDouble"><span class="hs-identifier hs-var">floatToDouble</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-1627434481"><a href="#local-1627434481"><span class="hs-identifier">sb</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627434482"><a href="#local-1627434482"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434483"><a href="#local-1627434483"><span class="hs-identifier">incx</span></a></a><span> </span><a name="local-1627434484"><a href="#local-1627434484"><span class="hs-identifier">sy</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434485"><a href="#local-1627434485"><span class="hs-identifier">incy</span></a></a><span>
</span><a name="line-239"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434480"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">1</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Util.html#doubleToFloat"><span class="hs-identifier hs-var">doubleToFloat</span></a><span> </span><a href="#local-1627434481"><span class="hs-identifier hs-var">sb</span></a><span>
</span><a name="line-240"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434483"><span class="hs-identifier hs-var">incx</span></a><span class="hs-operator hs-var">==</span><a href="#local-1627434485"><span class="hs-identifier hs-var">incy</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1627434483"><span class="hs-identifier hs-var">incx</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434486"><span class="hs-identifier hs-var">whenPositiveEqualInc</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434480"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434483"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434487"><span class="hs-identifier hs-var">whenUnequalOrNegIncs</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-1627434481"><span class="hs-identifier hs-var">sb</span></a><span> </span><span class="hs-special">(</span><a href="Numerical.BLAS.Single.html#firstIndex"><span class="hs-identifier hs-var">firstIndex</span></a><span> </span><a href="#local-1627434480"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434483"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Numerical.BLAS.Single.html#firstIndex"><span class="hs-identifier hs-var">firstIndex</span></a><span> </span><a href="#local-1627434480"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434485"><span class="hs-identifier hs-var">incy</span></a><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-243"></a><span>   </span><span class="hs-identifier">whenPositiveEqualInc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-244"></a><span>   </span><span class="hs-pragma">{-# INLINE whenPositiveEqualInc #-}</span><span>
</span><a name="line-245"></a><span>   </span><a name="local-1627434486"><a href="#local-1627434486"><span class="hs-identifier">whenPositiveEqualInc</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434488"><a href="#local-1627434488"><span class="hs-identifier">imax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434489"><span class="hs-identifier hs-var">whenPositiveEqualInc_loop</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-1627434481"><span class="hs-identifier hs-var">sb</span></a><span>
</span><a name="line-246"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-247"></a><span>       </span><span class="hs-identifier">whenPositiveEqualInc_loop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-248"></a><span>       </span><span class="hs-pragma">{-# INLINE whenPositiveEqualInc_loop #-}</span><span>
</span><a name="line-249"></a><span>       </span><a name="local-1627434489"><a href="#local-1627434489"><span class="hs-identifier">whenPositiveEqualInc_loop</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434490"><a href="#local-1627434490"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434491"><a href="#local-1627434491"><span class="hs-identifier">c</span></a></a><span>
</span><a name="line-250"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434490"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">&gt;=</span><a href="#local-1627434488"><span class="hs-identifier hs-var">imax</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Util.html#doubleToFloat"><span class="hs-identifier hs-var">doubleToFloat</span></a><span> </span><a href="#local-1627434491"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-251"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-252"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-1627434492"><a href="#local-1627434492"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434491"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="Numerical.BLAS.Util.html#floatToDouble"><span class="hs-identifier hs-var">floatToDouble</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="#local-1627434482"><span class="hs-identifier hs-var">sx</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeIndex</span><span class="hs-special">`</span><span> </span><a href="#local-1627434490"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span>                           </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="Numerical.BLAS.Util.html#floatToDouble"><span class="hs-identifier hs-var">floatToDouble</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="#local-1627434484"><span class="hs-identifier hs-var">sy</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeIndex</span><span class="hs-special">`</span><span> </span><a href="#local-1627434490"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>                </span><span class="hs-keyword">in</span><span> </span><a href="#local-1627434489"><span class="hs-identifier hs-var">whenPositiveEqualInc_loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434490"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><a href="#local-1627434483"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434492"><span class="hs-identifier hs-var">c'</span></a><span>
</span><a name="line-255"></a><span>   </span><span class="hs-identifier">whenUnequalOrNegIncs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-256"></a><span>   </span><span class="hs-pragma">{-# INLINE whenUnequalOrNegIncs #-}</span><span>
</span><a name="line-257"></a><span>   </span><a name="local-1627434487"><a href="#local-1627434487"><span class="hs-identifier">whenUnequalOrNegIncs</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434493"><a href="#local-1627434493"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434494"><a href="#local-1627434494"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434495"><a href="#local-1627434495"><span class="hs-identifier">kx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434496"><a href="#local-1627434496"><span class="hs-identifier">ky</span></a></a><span>
</span><a name="line-258"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434493"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-1627434480"><span class="hs-identifier hs-var">n</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Util.html#doubleToFloat"><span class="hs-identifier hs-var">doubleToFloat</span></a><span> </span><a href="#local-1627434494"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-259"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-260"></a><span>           </span><span class="hs-keyword">let</span><span> </span><a name="local-1627434497"><a href="#local-1627434497"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434494"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="Numerical.BLAS.Util.html#floatToDouble"><span class="hs-identifier hs-var">floatToDouble</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627434482"><span class="hs-identifier hs-var">sx</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeIndex</span><span class="hs-special">`</span><span> </span><a href="#local-1627434495"><span class="hs-identifier hs-var">kx</span></a><span class="hs-special">)</span><span>
</span><a name="line-261"></a><span>                      </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="Numerical.BLAS.Util.html#floatToDouble"><span class="hs-identifier hs-var">floatToDouble</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627434484"><span class="hs-identifier hs-var">sy</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeIndex</span><span class="hs-special">`</span><span> </span><a href="#local-1627434496"><span class="hs-identifier hs-var">ky</span></a><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span>           </span><span class="hs-keyword">in</span><span>  </span><a href="#local-1627434487"><span class="hs-identifier hs-var">whenUnequalOrNegIncs</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434493"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1627434497"><span class="hs-identifier hs-var">c'</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434495"><span class="hs-identifier hs-var">kx</span></a><span class="hs-operator hs-var">+</span><a href="#local-1627434483"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627434496"><span class="hs-identifier hs-var">ky</span></a><span class="hs-operator hs-var">+</span><a href="#local-1627434485"><span class="hs-identifier hs-var">incy</span></a><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">{- | O(1) Construct a plane Givens rotation on a deconstructed two-vector.
Specifically:

@
rotg sa sb = ( r, secant(theta), cos(theta), sin(theta))
@

where r is the signed magnitude of the vector &lt;sa,sb&gt;.   In the case when r
is zero, rotg returns (0,0,1,0).   See also &quot;rot&quot;.
-}</span><span>
</span><a name="line-274"></a><span class="hs-identifier">rotg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-1627434430"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-1627434430"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627434430"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>   </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627434430"><span class="hs-identifier hs-type">a</span></a><span>    </span><span class="hs-comment">-- ^ The x coordinate of the deconstructed vector</span><span>
</span><a name="line-276"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434430"><span class="hs-identifier hs-type">a</span></a><span>    </span><span class="hs-comment">-- ^ The y coordinate of the deconstructed vector</span><span>
</span><a name="line-277"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#GivensRot"><span class="hs-identifier hs-type">GivensRot</span></a><span> </span><a href="#local-1627434430"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The Givens rotation coefficients</span><span>
</span><a name="line-278"></a><span class="hs-pragma">{-# INLINE rotg #-}</span><span>
</span><a name="line-279"></a><a name="rotg"><a href="Numerical.BLAS.Single.html#rotg"><span class="hs-identifier">rotg</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434498"><a href="#local-1627434498"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434499"><a href="#local-1627434499"><span class="hs-identifier">sb</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-280"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627434502"><span class="hs-identifier hs-var">scale</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-281"></a><span>        </span><span class="hs-number">0.0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#GIVENSROT"><span class="hs-identifier hs-var">GIVENSROT</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627434500"><span class="hs-identifier hs-var">asa</span></a><span class="hs-operator hs-var">&gt;</span><a href="#local-1627434501"><span class="hs-identifier hs-var">asb</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-283"></a><span>            </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627434504"><a href="#local-1627434504"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">signum</span><span> </span><a href="#local-1627434498"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-1627434503"><span class="hs-identifier hs-var">magnitude</span></a><span>
</span><a name="line-284"></a><span>                        </span><a name="local-1627434505"><a href="#local-1627434505"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434499"><span class="hs-identifier hs-var">sb</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434504"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-285"></a><span>                    </span><span class="hs-keyword">in</span><span>  </span><a href="Numerical.BLAS.Types.html#GIVENSROT"><span class="hs-identifier hs-var">GIVENSROT</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434504"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><a href="#local-1627434505"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-1627434498"><span class="hs-identifier hs-var">sa</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434504"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><a href="#local-1627434505"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-286"></a><span>            </span><span class="hs-identifier hs-var">False</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627434506"><a href="#local-1627434506"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">signum</span><span> </span><a href="#local-1627434499"><span class="hs-identifier hs-var">sb</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-1627434503"><span class="hs-identifier hs-var">magnitude</span></a><span>
</span><a name="line-287"></a><span>                        </span><a name="local-1627434507"><a href="#local-1627434507"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434498"><span class="hs-identifier hs-var">sa</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434506"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-288"></a><span>                    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627434507"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-289"></a><span>                           </span><span class="hs-number">0.0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#GIVENSROT"><span class="hs-identifier hs-var">GIVENSROT</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434506"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>                           </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#GIVENSROT"><span class="hs-identifier hs-var">GIVENSROT</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627434506"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><a href="#local-1627434507"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="#local-1627434507"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="#local-1627434499"><span class="hs-identifier hs-var">sb</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434506"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-292"></a><span>        </span><a name="local-1627434500"><a href="#local-1627434500"><span class="hs-identifier">asa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-1627434498"><span class="hs-identifier hs-var">sa</span></a><span>
</span><a name="line-293"></a><span>        </span><a name="local-1627434501"><a href="#local-1627434501"><span class="hs-identifier">asb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-1627434499"><span class="hs-identifier hs-var">sb</span></a><span>
</span><a name="line-294"></a><span>        </span><a name="local-1627434502"><a href="#local-1627434502"><span class="hs-identifier">scale</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434500"><span class="hs-identifier hs-var">asa</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434501"><span class="hs-identifier hs-var">asb</span></a><span>
</span><a name="line-295"></a><span>        </span><a name="local-1627434503"><a href="#local-1627434503"><span class="hs-identifier">magnitude</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434502"><span class="hs-identifier hs-var">scale</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627434498"><span class="hs-identifier hs-var">sa</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434502"><span class="hs-identifier hs-var">scale</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">^</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-operator hs-var">+</span><span class="hs-special">(</span><a href="#local-1627434499"><span class="hs-identifier hs-var">sb</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434502"><span class="hs-identifier hs-var">scale</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">^</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-296"></a><span class="hs-pragma">{-# DEPRECATED srotg, drotg &quot;Use rotg instead.&quot; #-}</span><span>
</span><a name="line-297"></a><span class="hs-identifier">srotg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#GivensRot"><span class="hs-identifier hs-type">GivensRot</span></a><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-298"></a><a name="srotg"><a href="Numerical.BLAS.Single.html#srotg"><span class="hs-identifier">srotg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#rotg"><span class="hs-identifier hs-var">rotg</span></a><span>
</span><a name="line-299"></a><span class="hs-identifier">drotg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#GivensRot"><span class="hs-identifier hs-type">GivensRot</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-300"></a><a name="drotg"><a href="Numerical.BLAS.Single.html#drotg"><span class="hs-identifier">drotg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#rotg"><span class="hs-identifier hs-var">rotg</span></a><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-comment">{- | O(1) Construct a modified plane Givens rotation on a deconstructed
two-vector as described in &quot;Basic Linear Algebra Subprograms for Fortran
Use&quot;, Lawson 1979.  The solution should satisfy


  | d1 0 | | h11 h12 | | sx1/x1 |     | sd1 0   | | sx1 |
  | 0 d2 | | h21 h22 | | sy1/x1 | = G | 0   sd2 | | sx2 |
@

where G is the Givens rotation matirx.   d1, d2 and x1 are rescaled by the the
&quot;checkscale&quot; subprogram to be within the conservative limits of +/- 1/(4096)^2
and +/- 4096^2.

See also &quot;rotm&quot;.
-}</span><span>
</span><a name="line-318"></a><span class="hs-identifier">rotmg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627434429"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-1627434429"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-319"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627434429"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The first diagonal element sd1</span><span>
</span><a name="line-320"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434429"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The second diagonal element sd2</span><span>
</span><a name="line-321"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434429"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The first component of the vector sx1</span><span>
</span><a name="line-322"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434429"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The second component of the vector sx2</span><span>
</span><a name="line-323"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#ModGivensRot"><span class="hs-identifier hs-type">ModGivensRot</span></a><span> </span><a href="#local-1627434429"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The modified Givens Rotation coefficients</span><span>
</span><a name="line-324"></a><a name="rotmg"><a href="Numerical.BLAS.Single.html#rotmg"><span class="hs-identifier">rotmg</span></a></a><span> </span><a name="local-1627434508"><a href="#local-1627434508"><span class="hs-identifier">sd1</span></a></a><span> </span><a name="local-1627434509"><a href="#local-1627434509"><span class="hs-identifier">sd2</span></a></a><span> </span><a name="local-1627434510"><a href="#local-1627434510"><span class="hs-identifier">sx1</span></a></a><span> </span><a name="local-1627434511"><a href="#local-1627434511"><span class="hs-identifier">sy1</span></a></a><span>
</span><a name="line-325"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434508"><span class="hs-identifier hs-var">sd1</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Types.html#FLAGNEG1"><span class="hs-identifier hs-var">FLAGNEG1</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">d1</span><span class="hs-glyph">=</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">d2</span><span class="hs-glyph">=</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x1</span><span class="hs-glyph">=</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">h11</span><span class="hs-glyph">=</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">h12</span><span class="hs-glyph">=</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">h21</span><span class="hs-glyph">=</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">h22</span><span class="hs-glyph">=</span><span class="hs-number">0</span><span class="hs-special">}</span><span>
</span><a name="line-326"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434512"><span class="hs-identifier hs-var">sp2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Types.html#FLAGNEG2"><span class="hs-identifier hs-var">FLAGNEG2</span></a><span>
</span><a name="line-327"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434516"><span class="hs-identifier hs-var">asq1</span></a><span class="hs-operator hs-var">&gt;</span><a href="#local-1627434517"><span class="hs-identifier hs-var">asq2</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-328"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-1627434527"><a href="#local-1627434527"><span class="hs-identifier">sh21</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><a href="#local-1627434511"><span class="hs-identifier hs-var">sy1</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434510"><span class="hs-identifier hs-var">sx1</span></a><span>
</span><a name="line-329"></a><span>           </span><a name="local-1627434528"><a href="#local-1627434528"><span class="hs-identifier">sh12</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434512"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434513"><span class="hs-identifier hs-var">sp1</span></a><span>
</span><a name="line-330"></a><span>           </span><a name="local-1627434529"><a href="#local-1627434529"><span class="hs-identifier">su</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627434528"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434527"><span class="hs-identifier hs-var">sh21</span></a><span>
</span><a name="line-331"></a><span>      </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-1627434529"><span class="hs-identifier hs-var">su</span></a><span class="hs-operator hs-var">&gt;</span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>            </span><span class="hs-keyword">then</span><span> </span><a href="#local-1627434518"><span class="hs-identifier hs-var">mkparms</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Numerical.BLAS.Single.html#checkscale"><span class="hs-identifier hs-var">checkscale</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><a href="#local-1627434508"><span class="hs-identifier hs-var">sd1</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434529"><span class="hs-identifier hs-var">su</span></a><span class="hs-special">,</span><a href="#local-1627434509"><span class="hs-identifier hs-var">sd2</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434529"><span class="hs-identifier hs-var">su</span></a><span class="hs-special">,</span><a href="#local-1627434510"><span class="hs-identifier hs-var">sx1</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434529"><span class="hs-identifier hs-var">su</span></a><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><a href="#local-1627434528"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-special">,</span><a href="#local-1627434527"><span class="hs-identifier hs-var">sh21</span></a><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>            </span><span class="hs-keyword">else</span><span> </span><a href="#local-1627434518"><span class="hs-identifier hs-var">mkparms</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Numerical.BLAS.Single.html#checkscale"><span class="hs-identifier hs-var">checkscale</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><a href="#local-1627434508"><span class="hs-identifier hs-var">sd1</span></a><span class="hs-special">,</span><a href="#local-1627434509"><span class="hs-identifier hs-var">sd2</span></a><span class="hs-special">,</span><a href="#local-1627434510"><span class="hs-identifier hs-var">sx1</span></a><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><a href="#local-1627434528"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-special">,</span><a href="#local-1627434527"><span class="hs-identifier hs-var">sh21</span></a><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627434514"><span class="hs-identifier hs-var">sq2</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-335"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="#local-1627434518"><span class="hs-identifier hs-var">mkparms</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Numerical.BLAS.Single.html#checkscale"><span class="hs-identifier hs-var">checkscale</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-336"></a><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627434530"><a href="#local-1627434530"><span class="hs-identifier">su</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434531"><span class="hs-identifier hs-var">sh11</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434532"><span class="hs-identifier hs-var">sh22</span></a><span>
</span><a name="line-337"></a><span>               </span><a name="local-1627434531"><a href="#local-1627434531"><span class="hs-identifier">sh11</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434513"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434512"><span class="hs-identifier hs-var">sp2</span></a><span>
</span><a name="line-338"></a><span>               </span><a name="local-1627434532"><a href="#local-1627434532"><span class="hs-identifier">sh22</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434510"><span class="hs-identifier hs-var">sx1</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434511"><span class="hs-identifier hs-var">sy1</span></a><span>
</span><a name="line-339"></a><span>           </span><span class="hs-keyword">in</span><span>  </span><a href="#local-1627434518"><span class="hs-identifier hs-var">mkparms</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Numerical.BLAS.Single.html#checkscale"><span class="hs-identifier hs-var">checkscale</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-1627434509"><span class="hs-identifier hs-var">sd2</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434530"><span class="hs-identifier hs-var">su</span></a><span class="hs-special">,</span><a href="#local-1627434508"><span class="hs-identifier hs-var">sd1</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434530"><span class="hs-identifier hs-var">su</span></a><span class="hs-special">,</span><a href="#local-1627434511"><span class="hs-identifier hs-var">sy1</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434530"><span class="hs-identifier hs-var">su</span></a><span class="hs-special">,</span><a href="#local-1627434531"><span class="hs-identifier hs-var">sh11</span></a><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><a href="#local-1627434532"><span class="hs-identifier hs-var">sh22</span></a><span class="hs-special">)</span><span>
</span><a name="line-340"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-341"></a><span>   </span><a name="local-1627434512"><a href="#local-1627434512"><span class="hs-identifier">sp2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434509"><span class="hs-identifier hs-var">sd2</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434511"><span class="hs-identifier hs-var">sy1</span></a><span>
</span><a name="line-342"></a><span>   </span><a name="local-1627434513"><a href="#local-1627434513"><span class="hs-identifier">sp1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434508"><span class="hs-identifier hs-var">sd1</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434510"><span class="hs-identifier hs-var">sx1</span></a><span>
</span><a name="line-343"></a><span>   </span><a name="local-1627434514"><a href="#local-1627434514"><span class="hs-identifier">sq2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434512"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434511"><span class="hs-identifier hs-var">sy1</span></a><span>
</span><a name="line-344"></a><span>   </span><a name="local-1627434515"><a href="#local-1627434515"><span class="hs-identifier">sq1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434513"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434510"><span class="hs-identifier hs-var">sx1</span></a><span>
</span><a name="line-345"></a><span>   </span><a name="local-1627434516"><a href="#local-1627434516"><span class="hs-identifier">asq1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-1627434515"><span class="hs-identifier hs-var">sq1</span></a><span>
</span><a name="line-346"></a><span>   </span><a name="local-1627434517"><a href="#local-1627434517"><span class="hs-identifier">asq2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-1627434514"><span class="hs-identifier hs-var">sq2</span></a><span>
</span><a name="line-347"></a><span>   </span><span class="hs-pragma">{-# INLINE mkparms #-}</span><span>
</span><a name="line-348"></a><span>   </span><a name="local-1627434518"><a href="#local-1627434518"><span class="hs-identifier">mkparms</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627434519"><a href="#local-1627434519"><span class="hs-identifier">flag</span></a></a><span class="hs-special">,</span><a name="local-1627434520"><a href="#local-1627434520"><span class="hs-identifier">d1</span></a></a><span class="hs-special">,</span><a name="local-1627434521"><a href="#local-1627434521"><span class="hs-identifier">d2</span></a></a><span class="hs-special">,</span><a name="local-1627434522"><a href="#local-1627434522"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><a name="local-1627434523"><a href="#local-1627434523"><span class="hs-identifier">h11</span></a></a><span class="hs-special">,</span><a name="local-1627434524"><a href="#local-1627434524"><span class="hs-identifier">h12</span></a></a><span class="hs-special">,</span><a name="local-1627434525"><a href="#local-1627434525"><span class="hs-identifier">h21</span></a></a><span class="hs-special">,</span><a name="local-1627434526"><a href="#local-1627434526"><span class="hs-identifier">h22</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-349"></a><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-1627434519"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-350"></a><span>          </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#FLAGNEG1"><span class="hs-identifier hs-var">FLAGNEG1</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-351"></a><span>          </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#FLAG0"><span class="hs-identifier hs-var">FLAG0</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-352"></a><span>          </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#FLAG1"><span class="hs-identifier hs-var">FLAG1</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-353"></a><span class="hs-pragma">{-# DEPRECATED srotmg, drotmg &quot;Use rotmg instead.&quot; #-}</span><span>
</span><a name="line-354"></a><span class="hs-identifier">srotmg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#ModGivensRot"><span class="hs-identifier hs-type">ModGivensRot</span></a><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-355"></a><a name="srotmg"><a href="Numerical.BLAS.Single.html#srotmg"><span class="hs-identifier">srotmg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#rotmg"><span class="hs-identifier hs-var">rotmg</span></a><span>
</span><a name="line-356"></a><span class="hs-identifier">drotmg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#ModGivensRot"><span class="hs-identifier hs-type">ModGivensRot</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-357"></a><a name="drotmg"><a href="Numerical.BLAS.Single.html#drotmg"><span class="hs-identifier">drotmg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#rotmg"><span class="hs-identifier hs-var">rotmg</span></a><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-comment">-- | A helper function that ensures that the scale of sd1 and sd2 fall between</span><span>
</span><a name="line-360"></a><span class="hs-comment">-- 1.677E7 and 1/1.677E7.   This is called by srotmg to scale the modified</span><span>
</span><a name="line-361"></a><span class="hs-comment">-- Givens rotation matrix to avoid underflow.</span><span>
</span><a name="line-362"></a><span class="hs-pragma">{-# INLINE checkscale #-}</span><span>
</span><a name="line-363"></a><span class="hs-identifier">checkscale</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-364"></a><span>   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-1627434428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-365"></a><a name="checkscale"><a href="Numerical.BLAS.Single.html#checkscale"><span class="hs-identifier">checkscale</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434537"><span class="hs-identifier hs-var">checkscale2</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-1627434536"><span class="hs-identifier hs-var">checkscale1</span></a><span>
</span><a name="line-366"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-367"></a><span>   </span><a name="local-1627434533"><a href="#local-1627434533"><span class="hs-identifier">gam</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4096</span><span>
</span><a name="line-368"></a><span>   </span><a name="local-1627434534"><a href="#local-1627434534"><span class="hs-identifier">gamsq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1.67772E7</span><span>
</span><a name="line-369"></a><span>   </span><a name="local-1627434535"><a href="#local-1627434535"><span class="hs-identifier">rgamsq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">5.96046E-8</span><span>
</span><a name="line-370"></a><span>   </span><span class="hs-pragma">{-# INLINE checkscale1 #-}</span><span>
</span><a name="line-371"></a><span>   </span><a name="local-1627434536"><a href="#local-1627434536"><span class="hs-identifier">checkscale1</span></a></a><span> </span><a name="local-1627434539"><a href="#local-1627434539"><span class="hs-identifier">z</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1627434540"><a href="#local-1627434540"><span class="hs-identifier">sd1</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434540"><span class="hs-identifier hs-var">sd1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">=</span><a href="#local-1627434539"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-373"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434541"><span class="hs-identifier hs-var">gocheck1</span></a><span> </span><a href="#local-1627434539"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-374"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-375"></a><span>       </span><span class="hs-pragma">{-# INLINE gocheck1 #-}</span><span>
</span><a name="line-376"></a><span>       </span><a name="local-1627434541"><a href="#local-1627434541"><span class="hs-identifier">gocheck1</span></a></a><span> </span><a name="local-1627434543"><a href="#local-1627434543"><span class="hs-identifier">zz</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1627434544"><a href="#local-1627434544"><span class="hs-identifier">sd1'</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-377"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434544"><span class="hs-identifier hs-var">sd1'</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><a href="#local-1627434535"><span class="hs-identifier hs-var">rgamsq</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1627434544"><span class="hs-identifier hs-var">sd1'</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1627434534"><span class="hs-identifier hs-var">gamsq</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434543"><span class="hs-identifier hs-var">zz</span></a><span>
</span><a name="line-378"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434541"><span class="hs-identifier hs-var">gocheck1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627434542"><span class="hs-identifier hs-var">check1B</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627434538"><span class="hs-identifier hs-var">checkA</span></a><span> </span><a href="#local-1627434543"><span class="hs-identifier hs-var">zz</span></a><span>
</span><a name="line-379"></a><span>       </span><span class="hs-pragma">{-# INLINE check1B #-}</span><span>
</span><a name="line-380"></a><span>       </span><a name="local-1627434542"><a href="#local-1627434542"><span class="hs-identifier">check1B</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627434545"><a href="#local-1627434545"><span class="hs-identifier">f</span></a></a><span class="hs-special">,</span><a name="local-1627434546"><a href="#local-1627434546"><span class="hs-identifier">sd1'</span></a></a><span class="hs-special">,</span><a name="local-1627434547"><a href="#local-1627434547"><span class="hs-identifier">sd2</span></a></a><span class="hs-special">,</span><a name="local-1627434548"><a href="#local-1627434548"><span class="hs-identifier">sx1</span></a></a><span class="hs-special">,</span><a name="local-1627434549"><a href="#local-1627434549"><span class="hs-identifier">sh11</span></a></a><span class="hs-special">,</span><a name="local-1627434550"><a href="#local-1627434550"><span class="hs-identifier">sh12</span></a></a><span class="hs-special">,</span><a name="local-1627434551"><a href="#local-1627434551"><span class="hs-identifier">sh21</span></a></a><span class="hs-special">,</span><a name="local-1627434552"><a href="#local-1627434552"><span class="hs-identifier">sh22</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-381"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434553"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-1627434535"><span class="hs-identifier hs-var">rgamsq</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-1627434545"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434546"><span class="hs-identifier hs-var">sd1'</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-operator hs-var">^</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1627434547"><span class="hs-identifier hs-var">sd2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434548"><span class="hs-identifier hs-var">sx1</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434549"><span class="hs-identifier hs-var">sh11</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434550"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434551"><span class="hs-identifier hs-var">sh21</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434552"><span class="hs-identifier hs-var">sh22</span></a><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-1627434545"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434546"><span class="hs-identifier hs-var">sd1'</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-operator hs-var">^</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1627434547"><span class="hs-identifier hs-var">sd2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434548"><span class="hs-identifier hs-var">sx1</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434549"><span class="hs-identifier hs-var">sh11</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434550"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434551"><span class="hs-identifier hs-var">sh21</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434552"><span class="hs-identifier hs-var">sh22</span></a><span class="hs-special">)</span><span>
</span><a name="line-383"></a><span>           </span><span class="hs-keyword">where</span><span> </span><a name="local-1627434553"><a href="#local-1627434553"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-1627434546"><span class="hs-identifier hs-var">sd1'</span></a><span>
</span><a name="line-384"></a><span>   </span><span class="hs-pragma">{-# INLINE checkscale2 #-}</span><span>
</span><a name="line-385"></a><span>   </span><a name="local-1627434537"><a href="#local-1627434537"><span class="hs-identifier">checkscale2</span></a></a><span> </span><a name="local-1627434554"><a href="#local-1627434554"><span class="hs-identifier">z</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1627434555"><a href="#local-1627434555"><span class="hs-identifier">sd2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434555"><span class="hs-identifier hs-var">sd2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434554"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-387"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434556"><span class="hs-identifier hs-var">gocheck2</span></a><span> </span><a href="#local-1627434554"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-388"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-389"></a><span>       </span><span class="hs-pragma">{-# INLINE gocheck2 #-}</span><span>
</span><a name="line-390"></a><span>       </span><a name="local-1627434556"><a href="#local-1627434556"><span class="hs-identifier">gocheck2</span></a></a><span> </span><a name="local-1627434558"><a href="#local-1627434558"><span class="hs-identifier">zz</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1627434559"><a href="#local-1627434559"><span class="hs-identifier">sd2'</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-391"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434560"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-1627434535"><span class="hs-identifier hs-var">rgamsq</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1627434560"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1627434534"><span class="hs-identifier hs-var">gamsq</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434558"><span class="hs-identifier hs-var">zz</span></a><span>
</span><a name="line-392"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627434556"><span class="hs-identifier hs-var">gocheck2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627434557"><span class="hs-identifier hs-var">check2B</span></a><span> </span><a href="#local-1627434560"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627434538"><span class="hs-identifier hs-var">checkA</span></a><span> </span><a href="#local-1627434558"><span class="hs-identifier hs-var">zz</span></a><span>
</span><a name="line-393"></a><span>           </span><span class="hs-keyword">where</span><span> </span><a name="local-1627434560"><a href="#local-1627434560"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-1627434559"><span class="hs-identifier hs-var">sd2'</span></a><span>
</span><a name="line-394"></a><span>       </span><span class="hs-pragma">{-# INLINE check2B #-}</span><span>
</span><a name="line-395"></a><span>       </span><a name="local-1627434557"><a href="#local-1627434557"><span class="hs-identifier">check2B</span></a></a><span> </span><a name="local-1627434561"><a href="#local-1627434561"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627434562"><a href="#local-1627434562"><span class="hs-identifier">f</span></a></a><span class="hs-special">,</span><a name="local-1627434563"><a href="#local-1627434563"><span class="hs-identifier">sd1</span></a></a><span class="hs-special">,</span><a name="local-1627434564"><a href="#local-1627434564"><span class="hs-identifier">sd2'</span></a></a><span class="hs-special">,</span><a name="local-1627434565"><a href="#local-1627434565"><span class="hs-identifier">sx1</span></a></a><span class="hs-special">,</span><a name="local-1627434566"><a href="#local-1627434566"><span class="hs-identifier">sh11</span></a></a><span class="hs-special">,</span><a name="local-1627434567"><a href="#local-1627434567"><span class="hs-identifier">sh12</span></a></a><span class="hs-special">,</span><a name="local-1627434568"><a href="#local-1627434568"><span class="hs-identifier">sh21</span></a></a><span class="hs-special">,</span><a name="local-1627434569"><a href="#local-1627434569"><span class="hs-identifier">sh22</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434561"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-1627434535"><span class="hs-identifier hs-var">rgamsq</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-1627434562"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434563"><span class="hs-identifier hs-var">sd1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434564"><span class="hs-identifier hs-var">sd2'</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-operator hs-var">^</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1627434565"><span class="hs-identifier hs-var">sx1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434566"><span class="hs-identifier hs-var">sh11</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434567"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434568"><span class="hs-identifier hs-var">sh21</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434569"><span class="hs-identifier hs-var">sh22</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">)</span><span>
</span><a name="line-397"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-1627434562"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434563"><span class="hs-identifier hs-var">sd1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434564"><span class="hs-identifier hs-var">sd2'</span></a><span class="hs-operator hs-var">/</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-operator hs-var">^</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1627434565"><span class="hs-identifier hs-var">sx1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434566"><span class="hs-identifier hs-var">sh11</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434567"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434568"><span class="hs-identifier hs-var">sh21</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434569"><span class="hs-identifier hs-var">sh22</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434533"><span class="hs-identifier hs-var">gam</span></a><span class="hs-special">)</span><span>
</span><a name="line-398"></a><span>   </span><span class="hs-pragma">{-# INLINE checkA #-}</span><span>
</span><a name="line-399"></a><span>   </span><a name="local-1627434538"><a href="#local-1627434538"><span class="hs-identifier">checkA</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627434570"><a href="#local-1627434570"><span class="hs-identifier">f</span></a></a><span class="hs-special">,</span><a name="local-1627434571"><a href="#local-1627434571"><span class="hs-identifier">sd1</span></a></a><span class="hs-special">,</span><a name="local-1627434572"><a href="#local-1627434572"><span class="hs-identifier">sd2</span></a></a><span class="hs-special">,</span><a name="local-1627434573"><a href="#local-1627434573"><span class="hs-identifier">sx1</span></a></a><span class="hs-special">,</span><a name="local-1627434574"><a href="#local-1627434574"><span class="hs-identifier">sh11</span></a></a><span class="hs-special">,</span><a name="local-1627434575"><a href="#local-1627434575"><span class="hs-identifier">sh12</span></a></a><span class="hs-special">,</span><a name="local-1627434576"><a href="#local-1627434576"><span class="hs-identifier">sh21</span></a></a><span class="hs-special">,</span><a name="local-1627434577"><a href="#local-1627434577"><span class="hs-identifier">sh22</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-400"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627434570"><span class="hs-identifier hs-var">f</span></a><span class="hs-operator hs-var">==</span><span class="hs-number">0</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-1627434571"><span class="hs-identifier hs-var">sd1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434572"><span class="hs-identifier hs-var">sd2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434573"><span class="hs-identifier hs-var">sx1</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-1627434575"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434576"><span class="hs-identifier hs-var">sh21</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-1627434571"><span class="hs-identifier hs-var">sd1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434572"><span class="hs-identifier hs-var">sd2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434573"><span class="hs-identifier hs-var">sx1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627434574"><span class="hs-identifier hs-var">sh11</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-1627434577"><span class="hs-identifier hs-var">sh22</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span>
</span><a name="line-404"></a><span class="hs-comment">-- | O(n) apply a plane rotation to elements drawn from a pair of vectors.</span><span>
</span><a name="line-405"></a><span class="hs-comment">-- This is morally equivalent to rotating both vectors through an angle when</span><span>
</span><a name="line-406"></a><span class="hs-comment">-- n is equal to the length of both the vectors, and both incx and incy are</span><span>
</span><a name="line-407"></a><span class="hs-comment">-- unity.</span><span>
</span><a name="line-408"></a><span class="hs-identifier">rot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434427"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-1627434427"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-409"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>       </span><span class="hs-comment">-- ^ The number of elements to rotate</span><span>
</span><a name="line-410"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434427"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-comment">-- ^ The first vector to rotate, x</span><span>
</span><a name="line-411"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>       </span><span class="hs-comment">-- ^ The interval between rotated elements in the first vector, incx</span><span>
</span><a name="line-412"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434427"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-comment">-- ^ The second vector to rotate, y</span><span>
</span><a name="line-413"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>       </span><span class="hs-comment">-- ^ The interval between rotated elements in the second vector, incy</span><span>
</span><a name="line-414"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434427"><span class="hs-identifier hs-type">a</span></a><span>         </span><span class="hs-comment">-- ^ The cosine of the angle of rotation</span><span>
</span><a name="line-415"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434427"><span class="hs-identifier hs-type">a</span></a><span>         </span><span class="hs-comment">-- ^ The sine of the angle of rotation</span><span>
</span><a name="line-416"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434427"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434427"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the rotated vectors</span><span>
</span><a name="line-417"></a><a name="rot"><a href="Numerical.BLAS.Single.html#rot"><span class="hs-identifier">rot</span></a></a><span> </span><a name="local-1627434578"><a href="#local-1627434578"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434579"><a href="#local-1627434579"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-1627434580"><a href="#local-1627434580"><span class="hs-identifier">incx</span></a></a><span> </span><a name="local-1627434581"><a href="#local-1627434581"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-1627434582"><a href="#local-1627434582"><span class="hs-identifier">incy</span></a></a><span> </span><a name="local-1627434583"><a href="#local-1627434583"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627434584"><a href="#local-1627434584"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-418"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627434585"><a href="#local-1627434585"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627434586"><a href="#local-1627434586"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434583"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434585"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434584"><span class="hs-identifier hs-var">s</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434586"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434578"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434579"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-1627434580"><span class="hs-identifier hs-var">incx</span></a><span> </span><a href="#local-1627434581"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-1627434582"><span class="hs-identifier hs-var">incy</span></a><span>
</span><a name="line-419"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627434587"><a href="#local-1627434587"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-1627434588"><a href="#local-1627434588"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434583"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434587"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627434584"><span class="hs-identifier hs-var">s</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434588"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434578"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434581"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-1627434582"><span class="hs-identifier hs-var">incy</span></a><span> </span><a href="#local-1627434579"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-1627434580"><span class="hs-identifier hs-var">incx</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-420"></a><span class="hs-pragma">{-# DEPRECATED srot,drot &quot;Use rot instead.&quot; #-}</span><span>
</span><a name="line-421"></a><span class="hs-identifier">srot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-special">)</span><span>
</span><a name="line-422"></a><a name="srot"><a href="Numerical.BLAS.Single.html#srot"><span class="hs-identifier">srot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#rot"><span class="hs-identifier hs-var">rot</span></a><span>
</span><a name="line-423"></a><span class="hs-identifier">drot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-424"></a><a name="drot"><a href="Numerical.BLAS.Single.html#drot"><span class="hs-identifier">drot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#rot"><span class="hs-identifier hs-var">rot</span></a><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><span class="hs-comment">{- | O(n) compute the linear combination of elements drawn from two vectors
according.  This is morally equivalent to the linear combination of the two
vectors when n is the length of the vectors and both incx and incy are unity.
-}</span><span>
</span><a name="line-430"></a><span class="hs-identifier">axpy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434426"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-1627434426"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The number of elements</span><span>
</span><a name="line-432"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434426"><span class="hs-identifier hs-type">a</span></a><span>        </span><span class="hs-comment">-- ^ The scalar multiple for the first vector, a</span><span>
</span><a name="line-433"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434426"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The first vector, x</span><span>
</span><a name="line-434"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The interval between elements drawn from the first vector, incx</span><span>
</span><a name="line-435"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434426"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The second vector, y</span><span>
</span><a name="line-436"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The interval between elements drawn from the second vector, incy</span><span>
</span><a name="line-437"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434426"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The linear combination a*x + y</span><span>
</span><a name="line-438"></a><span class="hs-pragma">{-# INLINE axpy #-}</span><span>
</span><a name="line-439"></a><a name="axpy"><a href="Numerical.BLAS.Single.html#axpy"><span class="hs-identifier">axpy</span></a></a><span> </span><a name="local-1627434589"><a href="#local-1627434589"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434590"><a href="#local-1627434590"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627434591"><a href="#local-1627434591"><span class="hs-identifier">sx</span></a></a><span> </span><a name="local-1627434592"><a href="#local-1627434592"><span class="hs-identifier">incx</span></a></a><span> </span><a name="local-1627434593"><a href="#local-1627434593"><span class="hs-identifier">sy</span></a></a><span> </span><a name="local-1627434594"><a href="#local-1627434594"><span class="hs-identifier">incy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627434595"><a href="#local-1627434595"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-1627434596"><a href="#local-1627434596"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434595"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434590"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434596"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-1627434589"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434593"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434594"><span class="hs-identifier hs-var">incy</span></a><span> </span><a href="#local-1627434591"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434592"><span class="hs-identifier hs-var">incx</span></a><span>
</span><a name="line-440"></a><span class="hs-pragma">{-# DEPRECATED saxpy,daxpy &quot;Use axpy instead.&quot; #-}</span><span>
</span><a name="line-441"></a><span class="hs-identifier">saxpy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-442"></a><a name="saxpy"><a href="Numerical.BLAS.Single.html#saxpy"><span class="hs-identifier">saxpy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#axpy"><span class="hs-identifier hs-var">axpy</span></a><span>
</span><a name="line-443"></a><span class="hs-identifier">daxpy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-444"></a><a name="daxpy"><a href="Numerical.BLAS.Single.html#daxpy"><span class="hs-identifier">daxpy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#axpy"><span class="hs-identifier hs-var">axpy</span></a><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-comment">{- | O(n) apply a modified Givens rotation to elements drawn from a pair of
vectors according to the following specification:

@
srotm FLAGNEG2 n sx incx sy incy = (sx,sy)
srotm (FLAGNEG1 h11 h12 h21 h22) n sx incx sy incy =
   ( updateElems (\ x y -&gt; h11*x + h12*y) n sx incx sy incy
   , updateElems (\ y x -&gt; h21*x + h22*y) n sy incy sx incx)
srotm (FLAG0 h12 h21) n sx incx sy incy =
   ( updateElems (\ x y -&gt; x + h12*y) n sx incx sy incy
   , updateElems (\ y x -&gt; h21*x + y) n sy incy sx incx)
srotm (FLAG1 h11 h22) n sx incx sy incy =
   ( updateElems (\ x y -&gt; h11*x + y) n sx incx sy incy
   , updateElems (\ y x -&gt; -x + h22*y) n sy incy sx incx)
@
see also &quot;rotmg&quot;.
-}</span><span>
</span><a name="line-463"></a><span class="hs-identifier">rotm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">V</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-1627434425"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-1627434425"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Numerical.BLAS.Types.html#ModGivensRot"><span class="hs-identifier hs-type">ModGivensRot</span></a><span> </span><a href="#local-1627434425"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-465"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-466"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434425"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-467"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-468"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434425"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-469"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-470"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434425"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-1627434425"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-471"></a><span class="hs-pragma">{-# INLINE rotm #-}</span><span>
</span><a name="line-472"></a><a name="rotm"><a href="Numerical.BLAS.Single.html#rotm"><span class="hs-identifier">rotm</span></a></a><span> </span><a name="local-1627434597"><a href="#local-1627434597"><span class="hs-identifier">flag</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434598"><a href="#local-1627434598"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627434599"><a href="#local-1627434599"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434600"><a href="#local-1627434600"><span class="hs-identifier">incx</span></a></a><span> </span><a name="local-1627434601"><a href="#local-1627434601"><span class="hs-identifier">sy</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627434602"><a href="#local-1627434602"><span class="hs-identifier">incy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627434597"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-473"></a><span>    </span><a href="Numerical.BLAS.Types.html#FLAGNEG2"><span class="hs-identifier hs-var">FLAGNEG2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627434599"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">,</span><a href="#local-1627434601"><span class="hs-identifier hs-var">sy</span></a><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>    </span><a href="Numerical.BLAS.Types.html#FLAGNEG1"><span class="hs-identifier hs-var">FLAGNEG1</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627434603"><a href="#local-1627434603"><span class="hs-identifier">sh11</span></a></a><span> </span><a name="local-1627434604"><a href="#local-1627434604"><span class="hs-identifier">sh12</span></a></a><span> </span><a name="local-1627434605"><a href="#local-1627434605"><span class="hs-identifier">sh21</span></a></a><span> </span><a name="local-1627434606"><a href="#local-1627434606"><span class="hs-identifier">sh22</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-475"></a><span>        </span><span class="hs-special">(</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627434607"><a href="#local-1627434607"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627434608"><a href="#local-1627434608"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434603"><span class="hs-identifier hs-var">sh11</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434607"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434604"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434608"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434598"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434599"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434600"><span class="hs-identifier hs-var">incx</span></a><span> </span><a href="#local-1627434601"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434602"><span class="hs-identifier hs-var">incy</span></a><span>
</span><a name="line-476"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627434609"><a href="#local-1627434609"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-1627434610"><a href="#local-1627434610"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434605"><span class="hs-identifier hs-var">sh21</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434610"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434606"><span class="hs-identifier hs-var">sh22</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434609"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434598"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434601"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434602"><span class="hs-identifier hs-var">incy</span></a><span> </span><a href="#local-1627434599"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434600"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span>
</span><a name="line-477"></a><span>    </span><a href="Numerical.BLAS.Types.html#FLAG0"><span class="hs-identifier hs-var">FLAG0</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627434611"><a href="#local-1627434611"><span class="hs-identifier">sh12</span></a></a><span> </span><a name="local-1627434612"><a href="#local-1627434612"><span class="hs-identifier">sh21</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-478"></a><span>        </span><span class="hs-special">(</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627434613"><a href="#local-1627434613"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627434614"><a href="#local-1627434614"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434613"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434611"><span class="hs-identifier hs-var">sh12</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434614"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434598"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434599"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434600"><span class="hs-identifier hs-var">incx</span></a><span> </span><a href="#local-1627434601"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434602"><span class="hs-identifier hs-var">incy</span></a><span>
</span><a name="line-479"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627434615"><a href="#local-1627434615"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-1627434616"><a href="#local-1627434616"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434612"><span class="hs-identifier hs-var">sh21</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434616"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434615"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434598"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434601"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434602"><span class="hs-identifier hs-var">incy</span></a><span> </span><a href="#local-1627434599"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434600"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span>    </span><a href="Numerical.BLAS.Types.html#FLAG1"><span class="hs-identifier hs-var">FLAG1</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627434617"><a href="#local-1627434617"><span class="hs-identifier">sh11</span></a></a><span> </span><a name="local-1627434618"><a href="#local-1627434618"><span class="hs-identifier">sh22</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-481"></a><span>        </span><span class="hs-special">(</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627434619"><a href="#local-1627434619"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627434620"><a href="#local-1627434620"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627434617"><span class="hs-identifier hs-var">sh11</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434619"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434620"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434598"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434599"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434600"><span class="hs-identifier hs-var">incx</span></a><span> </span><a href="#local-1627434601"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434602"><span class="hs-identifier hs-var">incy</span></a><span>
</span><a name="line-482"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Numerical.BLAS.Util.html#updateElems"><span class="hs-identifier hs-var">updateElems</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627434621"><a href="#local-1627434621"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-1627434622"><a href="#local-1627434622"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><a href="#local-1627434622"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627434618"><span class="hs-identifier hs-var">sh22</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627434621"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627434598"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627434601"><span class="hs-identifier hs-var">sy</span></a><span> </span><a href="#local-1627434602"><span class="hs-identifier hs-var">incy</span></a><span> </span><a href="#local-1627434599"><span class="hs-identifier hs-var">sx</span></a><span> </span><a href="#local-1627434600"><span class="hs-identifier hs-var">incx</span></a><span class="hs-special">)</span><span>
</span><a name="line-483"></a><span class="hs-pragma">{-# DEPRECATED srotm,drotm &quot;Use rotm instead&quot; #-}</span><span>
</span><a name="line-484"></a><span class="hs-identifier">srotm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numerical.BLAS.Types.html#ModGivensRot"><span class="hs-identifier hs-type">ModGivensRot</span></a><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-485"></a><a name="srotm"><a href="Numerical.BLAS.Single.html#srotm"><span class="hs-identifier">srotm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#rotm"><span class="hs-identifier hs-var">rotm</span></a><span>
</span><a name="line-486"></a><span class="hs-identifier">drotm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numerical.BLAS.Types.html#ModGivensRot"><span class="hs-identifier hs-type">ModGivensRot</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-487"></a><a name="drotm"><a href="Numerical.BLAS.Single.html#drotm"><span class="hs-identifier">drotm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numerical.BLAS.Single.html#rotm"><span class="hs-identifier hs-var">rotm</span></a><span>
</span><a name="line-488"></a></pre></body></html>